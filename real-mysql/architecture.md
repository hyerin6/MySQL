# MySQL 아키텍처      

쿼리를 작성하고 튜닝할 때 필요한 기본적인 구조에 대해서 알아보자.   


## MySQL의 전체 구조    

![스크린샷 2021-01-12 오전 12 20 44](https://user-images.githubusercontent.com/33855307/104200470-0e6a9800-546c-11eb-9aa0-cdc3a0db6534.png)     
<br />          


* MySQL 엔진    
클라이언트로부터 접속 및 쿼리 요청을 처리하는 커넥션 핸들러, SQL 파서 및 전처리기, 쿼리 최적화 실행을 위한 옵티마이저가 중심을 이룬다.   
또한 성능 향상을 위한 MyISAM의 키 캐시, InnoDB의 버퍼 풀이 포함된다.     

* 스토리지 엔진   
실제 데이터를 디스크 스토리지에 저장하거나 읽어오는 부분을 스토리지 엔진이 전담한다.     
예) `CREATE TABLE test_table(fd1 INT) ENGINE=INNODB;`      
위 예제는 InnoDB 스토리지 엔진을 사용하도록 정의한 것이다.       
test_table에 대한 쿼리 작업을 InnoDB 스토리지 엔진이 담당한다.   

* 핸들러 API   
MySQL 엔진의 쿼리 실행기에서 데이터를 쓰거나 읽어야 할 때 각 스토리지 엔진에 요청을 하는데,             
이러한 요청을 핸들러 요청이라고 하며 여기서 사용되는 API를 핸들러 API라고 한다.             
<br />           

## MySQL 스레딩 구조      

![스크린샷 2021-01-12 오전 12 37 18](https://user-images.githubusercontent.com/33855307/104202502-58ed1400-546e-11eb-9b1a-ce3f749fcf75.png)     

MySQL 서버는 프로세스 기반이 아니라 스레드 기반으로 작동하며, 크게 포그라운드 스레드와 백그라운드 스레드로 구분할 수 있다.      


* 포그라운드 스레드 (클라이언트 스레드)   
포그라운드 스레드는 최소한 MySQL 서버에 접속된 클라이언트 수만큼 존재하며, 주로 각 클라이언트 사용자가 요청하는 쿼리 문장을 처리하는 것이 임무다.    

* 백드라운드 스레드       
MyISAM의 경우 별로 해당사항이 없지만 InnoDB는 여러 가지 작업이 백그라운드로 처리된다.        
모두 중요한 역할을 하지만 가장 중요한 것은 로그 스레드와 버퍼의 데이터를 디스크로 내려쓰는 작업을 처리하는 쓰기 스레드다.   
<br />      


## 메모리 할당 및 사용 구조    

![스크린샷 2021-01-12 오전 12 48 51](https://user-images.githubusercontent.com/33855307/104203856-f4cb4f80-546f-11eb-8282-c57a121ed080.png)    

* 글로벌 메모리 영역 
* 로컬 메모리 영역      
   









